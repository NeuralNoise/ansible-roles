---
- hosts: all
  pre_tasks:
    - file: dest=/www/test-flask state=directory
    - copy: dest=/www/test-flask/testapp.py src=test_files/testapp.py
  roles:
    - uwsgi
    - { role: uwsgi-python-app,
        app_name: "test-flask",
        python_packages: ['Flask'],
        uwsgi: {
            module: "testapp:app",
            http: ":8080",
            master: "true"
        }
    }
  sudo: yes
  vars:
    uwsgi_install_method: pip